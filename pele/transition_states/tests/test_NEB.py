import unittest

import numpy as np

from pele.transition_states import NEBDriver
from pele.potentials import LJ


_x1 = np.array([1.33553771, -0.68037346, 0.34217452, 0.99605849, 0.3991415,
                0.22669776, -0.40689511, -0.69241725, -0.25056957, 1.31739168,
                -1.16646925, -0.68608386, 0.76810225, 0.58022255, -0.87292919,
                0.96669726, -0.38737814, -1.43705923, 0.24050881, -1.17391284,
                -1.05241976, 0.61828363, -0.38738569, -0.41286104, 0.46846513,
                -1.35499386, 0.0472071, -0.08082435, 0.3916979, -0.1396383,
                -0.09897039, -0.09439797, -1.16789673, 0.26987003, -0.38739314,
                0.61133724, 1.64346237, -0.08235405, -0.57515248])
_x2 = np.array([1.1518068, -0.61649265, 0.50664924, 1.493744, 0.21387667,
                -0.1979153, -1.04716736, -0.65857457, 0.08353891, 1.57953469,
                -0.88140956, -0.50422937, 0.57932209, 0.65531978, -0.71926603,
                1.22536469, -0.09459541, -1.26264836, -0.25717727, -0.9886478,
                -0.62780671, 0.61828361, -0.38738579, -0.41286143, 0.65724469,
                -1.43009114, -0.10645631, -0.34296759, 0.10663783, -0.32149307,
                0.08476076, -0.15827869, -1.33237198, 0.01120334, -0.6801752,
                0.43692631, 2.28373508, -0.11619716, -0.90925944])


class TestNEB(unittest.TestCase):
    def test1(self):
        np.random.seed(0)

        pot = LJ()

        neb = NEBDriver(pot, _x1, _x2, adjustk_freq=10, adaptive_nimages=True, adaptive_niter=True, reinterpolate=10)
        neb.run()


if __name__ == "__main__":
    unittest.main()
